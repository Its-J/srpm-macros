## Evaluation macro to expand later and a bcond for if Electron is bundled or not for meta/license macros so they can be used for Electron itself
## %%with_bundled_electron alone does not work because the name macro is defined in the spec itself
%is_electron_bundled() %bcond bundled_electron %["%{name}" != "electron"]

%electron_arches %{x86_64} %{ix86} %{arm64} armv7l armv7hl armv7hnl %{mips64}

## NOTE: Best for pure Electron programs. If packages use binaries not made with Electron Builder, when using this Macro care must be taken to not cause overlapping licenses.
## The SOURCE LICENSE of Electron is MIT. However, as it uses Chromium code, the Chromium license comes bundled with it and all Electron apps. Electron ALSO bundles FFmpeg and code from vulkan-loader.
## REMEMBER to add the license of the app itself if it is not covered here!
## In order, the bundled licenses:
# vulkan-loader: Apache-2.0
# FFmpeg: LGPL-3.0-or-later
# Electron itself: MIT
# Bundled Electron: MIT AND (BSD-3-Clause AND LGPL-2.1-or-later AND Apache-2.0 AND IJG AND MIT AND GPL-2.0-or-later AND ISC AND OpenSSL AND (MPL-1.1 OR GPL-2.0-only OR LGPL-2.0-only))
# Chromium: BSD-3-Clause AND LGPL-2.1-or-later AND Apache-2.0 AND IJG AND MIT AND GPL-2.0-or-later AND ISC AND OpenSSL AND (MPL-1.1 OR GPL-2.0-only OR LGPL-2.0-only)
%electron_license %{is_electron_bundled}%{?with_bundled_electron:%{shrink:
Apache-2.0
AND
LGPL-3.0-or-later
AND
MIT
AND
(MIT AND (BSD-3-Clause AND LGPL-2.1-or-later AND Apache-2.0 AND IJG AND MIT AND GPL-2.0-or-later AND ISC AND OpenSSL AND (MPL-1.1 OR GPL-2.0-only OR LGPL-2.0-only)))}}%{!?with_bundled_electron:%{shrink:
Apache-2.0
AND
LGPL-3.0-or-later
AND
MIT
AND
(BSD-3-Clause AND LGPL-2.1-or-later AND Apache-2.0 AND IJG AND MIT AND GPL-2.0-or-later AND ISC AND OpenSSL AND (MPL-1.1 OR GPL-2.0-only OR LGPL-2.0-only))}}

## Note: This does NOT automatically pull Bun/PNPM/Yarn or any other build dependencies. Those must be specified, this meta macro only sets the bare minimum that is consistently needed for Electron builds.
## nodejs-packaging is REQUIRED if using Fedora Node.js macros such as %%{__nodejs}
## Package requirements are only the requirements for Electron itself. Electron apps may have additional requirements.
# -a: "All/additional." Additional build deps that may be needed specifically for when building with NPM.
# -D: "Disable debug." Disable debug packages. Needed for most Electron apps.
%electronmeta(aD)                                                                                                                  \
%{-D:%global debug_package %{nil}}                                                                                                 \
%global __provides_exclude ^((libffmpeg\\.so.*)|(libEGL\\.so.*)|(libGLESv2\\.so.*)|(libvk_swiftshader\\.so.*)|(libvulkan\\.so.*))$ \
%{lua:
  if not macros["_target_cpu"]:find('armv7') then
    for arch in string.gmatch(macros["x86_64"], "%S+") do
      if macros["_target_cpu"] == arch then
        macros["__requires_exclude"] = '^((libffmpeg\\\\.so.*)|(libGLESv2\\\\.so.*)|(libEGL\\\\.so.*)|(libvk_swiftshader\\\\.so.*)|(libvulkan\\\\.so.*)|(.*\\\\aarch64*\\\\.so.*)|(.*x86-32.*)|(.*\\\\armhf*\\\\.so.*)|(libc\\\\.musl.*\\\\.so.*)|(libgcc_s\\\\.so.*)|(libpthread\\\\.so.*)|(.*_ARM_.*)|(.*aarch-64.*)|(.*mips64.*)|(ld\\\\.so\\\\.[[:digit:]+]))$'
        macros["_electron_cpu"] = 'x64'
      end
    end
    for arch in string.gmatch(macros["ix86"], "%S+") do
      if macros["_target_cpu"] == arch then
        macros["__requires_exclude"] = '^((libffmpeg\\\\.so.*)|(libGLESv2\\\\.so.*)|(libEGL\\\\.so.*)|(libvk_swiftshader\\\\.so.*)|(libvulkan\\\\.so.*)|(.*\\\\x86_64*\\\\.so.*)|(.*x86-64.*)|(.*\\\\aarch64*\\\\.so.*)|(.*\\\\armhf*\\\\.so.*)|(libc\\\\.musl.*\\\\.so.*)|(libgcc_s\\\\.so.*)|(libpthread\\\\.so.*)|(.*_ARM_.*)|(.*64bit.*)|(.*aarch-64.*)|(.*mips64.*)|(ld\\\\.so\\\\.[[:digit:]+]))$'
        macros["_electron_cpu"] = 'ia32'
      end
    end
    for arch in string.gmatch(macros["arm64"], "%S+") do
      if macros["_target_cpu"] == arch then
        macros["__requires_exclude"] = '^((libffmpeg\\\\.so.*)|(libGLESv2\\\\.so.*)|(libEGL\\\\.so.*)|(libvk_swiftshader\\\\.so.*)|(libvulkan\\\\.so.*)|(.*\\\\x86_64*\\\\.so.*)|(.*x86-64.*)|(.*x86-32.*)|(.*\\\\armhf*\\\\.so.*)|(libc\\\\.musl.*\\\\.so.*)|(libgcc_s\\\\.so.*)|(libpthread\\\\.so.*)|(.*_ARM_.*)|(.*mips64.*)|(ld\\\\.so\\\\.[[:digit:]+]))$'
        macros["_electron_cpu"] = 'arm64'
        print("BuildRequires: zlib-ng-compat-devel")
      end
    end
    for arch in string.gmatch(macros["mips64"], "%S+") do
      if macros["_target_cpu"] == arch then
        macros["__requires_exclude"] = '^((libffmpeg\\\\.so.*)|(libGLESv2\\\\.so.*)|(libvk_swiftshader\\\\.so.*)|(libvulkan\\\\.so.*)|(.*\\\\x86_64*\\\\.so.*)|(.*x86-64.*)|(.*\\\\aarch64*\\\\.so.*)|(.*x86-32.*)|(.*\\\\armhf*\\\\.so.*)|(libc\\\\.musl.*\\\\.so.*)|(libgcc_s\\\\.so.*)|(libpthread\\\\.so.*)|(.*64bit.*)|(.*aarch-64.*)|(.*_ARM_.*))$'
        macros["_electron_cpu"] = 'mips64el'
      end
    end
  elseif macros["_target_cpu"]:find('armv7') then
    macros["__requires_exclude"] = '^((libffmpeg\\\\.so.*)|(libGLES.*\\\\.so.*)|(libEGL\\\\.so.*)|(libvk_swiftshader\\\\.so.*)|(libvulkan\\\\.so.*)|(.*\\\\x86_64*\\\\.so.*)|(.*x86-64.*)|(.*\\\\aarch64*\\\\.so.*)|(.*x86-32.*)|(libc\\\\.musl.*\\\\.so.*)|(libgcc_s\\\\.so.*)|(libpthread\\\\.so.*)|(.*64bit.*)|(.*aarch-64.*)|(.*mips64.*)|(ld\\\\.so\\\\.[[:digit:]+]))$'
    macros["_electron_cpu"] = 'armv7l'
    print("BuildRequires: zlib-ng-compat-devel")
  end}                                                                                                                             \
%{is_electron_bundled}%{?with_bundled_electron:%{expand:BuildRequires: desktop-file-utils
BuildRequires: gcc
BuildRequires: gcc-c++
BuildRequires: git-core
BuildRequires: make
BuildRequires: nodejs%{-a:%{expand:
BuildRequires: nodejs-devel}}
BuildRequires: nodejs-npm%{-a:%{expand:
BuildRequires: nodejs-packaging}}
BuildRequires: python3%{-a:%{expand:
BuildRequires: typescript}}}}%{!?with_bundled_electron:%{expand:
BuildRequires: unzip}}                                                                                                             \
Requires:      at-spi2-core                                                                                                        \
Requires:      c-ares                                                                                                              \
Requires:      gtk3%{!?with_bundled_electron:%{expand:
Requires:      minizip}}                                                                                                           \
Requires:      (libuuid or libuuid1)                                                                                               \
Requires:      libnotify                                                                                                           \
Requires:      libXScrnSaver                                                                                                       \
Requires:      (libXtst or libXtst6)                                                                                               \
Requires:      nss                                                                                                                 \
Requires:      re2                                                                                                                 \
Requires:      xdg-utils                                                                                                           \
%{?with_bundled_electron:Provides:      bundled(electron)}%{!?with_bundled_electron:Provides:      bundled(chromium)}              \
Provides:      bundled(ffmpeg)                                                                                                     \
Provides:      bundled(vulkan-loader)                                                                                              \
ExclusiveArch: %{electron_arches}

## NPM is usually NOT how Electron projects are built and almost any other build system is preferrable. This macro has MANY flags to work around these and will fail if no necessary ones are detected. Capital letter flags are for use with calling Electron Builder.
## Generally, -e and -r should be used. However, -E and -V can also be used if a project has a relatively simple build process.
## Because of the way NPM projects are sometimes set up, -E and -V issue a warning.
# -c: "CI/clean install." Boolean to use npm ci instead of npm install. Needed for some projects with stricter build dependencies.
# -C: "Config." Direct Electron Builder to the config file. May be necessary with NPM.
# -e: "Exec." Execute commands though NPM directly. Note that some commands longer than one word MUST have -- follow the first word to be passed to the command, especially if they are passing arguments to a Node module.
# -E: "Electron Builder/Electron Forge." Directly execute Electron Builder or Electron Forge. Will NOT work in projects that need build commands executed via Node.js instead of NPM.
# -M: "Mode." Mode to use in Electron Vite builds.
# -r: "Run." Project-specific scripts to run.
# -V: "Vite." Directly execute Electron Vite. Has the same limitation as -E.
%npm_build(cC:eEM:r:V)                                                                                                                           \
%{!?-e:%{!?-r:%{!?-E:%{error:Necessary build args not detected! This macro REQUIRES use of -e, -r, or -E.}}}}                                    \
%{lua:
  if opt.E or opt.V then
    print("set +x; echo -e \\"NOTE: Use of -E and -V may not work with all NPM built projects.\\"; set -x")
  end}                                                                                                                                           \
if cat package.json | grep electron-builder &>/dev/null; then                                                                                    \
  BUILDER="electron-builder"                                                                                                                     \
elif cat package.json | grep electron-forge &>/dev/null; then                                                                                    \
  BUILDER="electron-forge"                                                                                                                       \
fi                                                                                                                                               \
%{__npm} %{!?-c:install}%{-c:ci}                                                                                                                 \
%{lua:
  if opt.e then
    print(rpm.expand("HOME=%{rpmbuilddir} %{__npm} exec"))
    for i, cmd in ipairs(arg) do
      print(" " .. cmd)
    end
    print("\\n")
  end}                                                                                                                                           \
%{-r:HOME=%{rpmbuilddir} %{__npm} run %{-r*}}                                                                                                    \
%{-V:HOME=%{rpmbuilddir} %{__npm} exec electron-vite -- build %{-M:--mode %{-M*}}}                                                               \
%{-E:%{expand:
if [[ "$BUILDER" == "electron-builder" ]]; then
HOME=%{rpmbuilddir} %{__npm} exec electron-builder -- --linux --%{_electron_cpu} --publish=never %{-C:-c %{-C*}}
elif [[ "$BUILDER" == "electron-forge" ]]; then
%{__npm} install @reforged/maker-appimage --no-save --no-audit
HOME=%{rpmbuilddir} %{__npm} exec electron-forge make -- --platform="linux" --arch="%{_electron_cpu}" --targets="@reforged/maker-appimage"
fi}}

## Capital letters denote potentially risky build options as they may change intended build behavior.
# -c: "CI/clean install." Equivalent to using "bun install --frozen-lockfile".
# -e: "Exec." Execute commands though Bun directly. Not recommended for Electron Builder/Electron Vite commands.
# -F: "Force." Always request the latest versions from the NPM Registry and reinstall all dependenices
# -N: "No save." Do not create a lockfile. Prevents freezing dependencies.
# -r: "Run." Project-specific scripts to run. Not recommended for Electron Builder/Electron Vite commands.
# -R: "Remove lockfile." Remove the lockfile if it is causing issues (i.e., the project has forgotten to update a dependency in it)
# -v: "Vite." Run Electron Vite builds
%bun_build(ceFNRr:v)                                                                                                                   \
%{-c:%{-R:%{error:Can't use both -c and -R}}}                                                                                          \
%{-c:%{-N:%{error:Can't use both -c and -N}}}                                                                                          \
if cat package.json | grep electron-builder &>/dev/null; then                                                                          \
  BUILDER="electron-builder"                                                                                                           \
elif cat package.json | grep electron-forge &>/dev/null; then                                                                          \
  BUILDER="electron-forge"                                                                                                             \
fi                                                                                                                                     \
%{-R:set +x; echo "WARNING: Removing bun.lock. This is not recommended unless absolutely necessary."; set -x}                          \
%{-R:%{__rm} -f bun.lock}                                                                                                              \
%{__bun} %{-c:ci}%{!?-c:install} %{-F:--force} %{-N:--no-save}                                                                         \
%{lua:
  if opt.e then
    print(rpm.expand("%{__bun} exec"))
    for i, cmd in ipairs(arg) do
      print(" " .. cmd)
    end
    print("\\n")
  end}                                                                                                                                 \
%{-r:%{__bun} run %{-r*}}                                                                                                              \
%{-v:HOME=%{rpmbuilddir} %{__bunx} electron-vite build}                                                                                \
if [[ "$BUILDER" == "electron-builder" ]]; then                                                                                        \
HOME=%{rpmbuilddir} %{__bunx} electron-builder --linux --%{_electron_cpu} --publish=never                                              \
elif [[ "$BUILDER" == "electron-forge" ]]; then                                                                                        \
%{__bun} install @reforged/maker-appimage --no-save --no-verify                                                                        \
HOME=%{rpmbuilddir} %{__bunx} electron-forge make -- --platform="linux" --arch="%{_electron_cpu}" --targets="@reforged/maker-appimage" \
fi

## Capital letters denote potentially risky build options as they may change intended build behavior.
# -e: "Exec." Execute commands though PNPM directly. Not recommended for Electron Builder/Electron Vite commands. Usually, the actual "exec" part of the command is optional. However, this macro calls it explicitly.
# -F: "Frozen lockfile." Build with a frozen lockfile.
# -N: "No frozen lockfile." Override a project's frozen lockfile to build with an unfrozen one.
# -r: "Run." Project-specific scripts to run. Not recommended for Electron Builder/Electron Vite commands.
# -R: "Recursive." For use with PNPM exec. Runs on every project in the workspace so use with caution.
# -v: "Vite." Run electron-vite builds.
%pnpm_build(eFNr:Rv)                                                                                                                   \
%{-F:%{-N:%{error:Can't use both -F and -N}}}                                                                                          \
if cat package.json | grep electron-builder &>/dev/null; then                                                                          \
  BUILDER="electron-builder"                                                                                                           \
elif cat package.json | grep electron-forge &>/dev/null; then                                                                          \
  BUILDER="electron-forge"                                                                                                             \
fi                                                                                                                                     \
%{__pnpm} install %{-F:--frozen-lockfile}%{-N:--no-frozen-lockfile}                                                                    \
%{lua:
  if opt.e then
    print(rpm.expand("%{__pnpm} %{-R:-r} exec"))
    for i, cmd in ipairs(arg) do
      print(" " .. cmd)
    end
    print("\\n")
  end}                                                                                                                                 \
%{-r:%{__pnpm} run %{-r*}}                                                                                                             \
%{-v:HOME=%{rpmbuilddir} %{__pnpm} electron-vite build}                                                                                \
if [[ "$BUILDER" == "electron-builder" ]]; then                                                                                        \
HOME=%{rpmbuilddir} %{__pnpm} electron-builder --linux --%{_electron_cpu} --publish=never                                              \
elif [[ "$BUILDER" == "electron-forge" ]]; then                                                                                        \
%{__pnpm} install @reforged/maker-appimage --no-lockfile                                                                               \
HOME=%{rpmbuilddir} %{__pnpm} electron-forge make -- --platform="linux" --arch="%{_electron_cpu}" --targets="@reforged/maker-appimage" \
fi

## Capital letters denote potentially risky build options as they may change intended build behavior.
# -e: "Exec." Execute commands though Yarn directly. Not recommended for Electron Builder/Electron Vite commands.
# -F: "Frozen lockfile." Build with a frozen lockfile.
# -N: "No frozen lockfile." Override a project's frozen lockfile to build with an unfrozen one.
# -r: "Run." Project-specific scripts to run. Not recommended for Electron Builder/Electron Vite commands.
# -v: "Vite." Run electron-vite builds.
%yarn_build(eFNr:v)                                                                                                                    \
%{-F:%{-N:%{error:Can't use both -F and -N}}}                                                                                          \
if cat package.json | grep electron-builder &>/dev/null; then                                                                          \
  BUILDER="electron-builder"                                                                                                           \
elif cat package.json | grep electron-forge &>/dev/null; then                                                                          \
  BUILDER="electron-forge"                                                                                                             \
fi                                                                                                                                     \
%{__yarn} install %{-F:--frozen-lockfile}%{-N:--no-lockfile}                                                                           \
%{lua:
  if opt.e then
    print(rpm.expand("%{__yarn} exec"))
    for i, cmd in ipairs(arg) do
      print(" " .. cmd)
    end
    print("\\n")
  end}                                                                                                                                 \
%{-r:%{__yarn} run %{-r*}}                                                                                                             \
%{-v:HOME=%{rpmbuilddir} %{__yarn} electron-vite build}                                                                                \
if [[ "$BUILDER" == "electron-builder" ]]; then                                                                                        \
HOME=%{rpmbuilddir} %{__yarn} electron-builder --linux --%{_electron_cpu} --publish=never                                              \
elif [[ "$BUILDER" == "electron-forge" ]]; then                                                                                        \
%{__yarn} install @reforged/maker-appimage --no-lockfile                                                                               \
HOME=%{rpmbuilddir} %{__yarn} electron-forge make -- --platform="linux" --arch="%{_electron_cpu}" --targets="@reforged/maker-appimage" \
fi

## Capital letters denote use in desktop file install process. These are capitalized differently for organizational purposes.
# If no alternative names are provided via flag everything, falls back to the name set by the spec
# -b: "Binary." Name of the actual executable file.
# -d: "Directory." Choose a different name for the install directory in /usr/lib(64)
# -D: "Desktop file." Handle automatic installation of .desktop file.
# -E: "Enable features." For use with desktop file install. Comma separated.
# -F: "Flags." Additional flags. Examples: no-sandbox disable-gpu-sandbox
# -O: "Ozone platform." For use with desktop file install. Default is "auto." Some programs MUST fall back to X11 for various reasons. Example: %%electron_install -O OR %%electron_install -Ox11
# -U:  Set %u or %U in the desktop file.
# -i: "Icons." Choose a different name to install the icon files under.
# -l: "Licenses." Use this if you want to collect all extra licenses into a directory called bundled_licenses automatically to package them via RPM. DOES NOT include build dep licenses. If using this macro you should add "%%license bundled_licenses/*" to the files section.
# -s: "Symlink." Name of the symlink to the executable.
# -S: Additional symlink to the binary. ONLY do this if a program has two common names, i.e, Heroic being called both "heroic" and "heroic-games-launcher"
%electron_install(b:d:DE:Fi:lO::s:S:U:)                         \
if cat package.json | grep electron-builder &>/dev/null; then   \
  BUILDER="electron-builder"                                    \
  APPOUTDIR="./dist"                                            \
  if [[ "%{_electron_cpu}" == "x64" ]]; then                    \
    OUTDIR="./dist/linux-unpacked"                              \
    APPARCH="x86_64"                                            \
  elif [[ "%{_electron_cpu}" == "ia32" ]]; then                 \
    OUTDIR="./dist/linux-%{_electron_cpu}-unpacked"             \
    APPARCH="i386"                                              \
  else                                                          \
    OUTDIR="./dist/linux-%{_electron_cpu}-unpacked"             \
    APPARCH="%{_electron_cpu}"                                  \
  fi                                                            \
elif cat package.json | grep electron-forge &>/dev/null; then   \
  BUILDER="electron-forge"                                      \
  OUTDIR="./out/*-linux-%{_electron_cpu}"                       \
  APPOUTDIR="./out/make/AppImage/%{_electron_cpu}"              \
  APPARCH="%{_electron_cpu}"                                    \
fi                                                              \
%{lua:
   local bin = macros["-b*"] or macros["name"]
   local dir = macros["-d*"] or macros["name"]
   local installdir = rpm.expand("%{_libdir}/") .. dir
   local link = macros["-s*"] or macros["name"]
   print(rpm.expand("%{__mkdir} -p %{buildroot}") .. installdir .. "\\n")
   print(rpm.expand("%{__cp} -pr $OUTDIR/* -t %{buildroot}") .. installdir .. "\\n")
   print(rpm.expand("%{__mkdir} -p %{buildroot}%{_bindir}\\n"))
   print(macros["__ln_s"] .. "f " .. installdir .. "/" .. bin .. rpm.expand(" %{buildroot}%{_bindir}/") .. link .. "\\n")
   if opt.S then
     print(macros["__ln_s"] .. "f " .. installdir .. "/" .. bin .. rpm.expand(" %{buildroot}%{_bindir}/%{-S*}\\n"))
   end
   if opt.D then
     print(rpm.expand("$APPOUTDIR/*$APPARCH.AppImage --appimage-extract '*.desktop'\\n"))
     print(rpm.expand("%{__sed} -i '/.*AppImage.*/d' squashfs-root/*.desktop\\n"))
   if opt.F then
     if not arg[1] then
       error("Extra flags not supplied.")
     else
       macros["desktop_file_args"] = table.concat(arg, " --")
     end
   end
     print("/usr/bin/desktop-file-install --set-key=Exec --set-value=\\"" .. installdir .. "/" .. bin .. rpm.expand("%{-E: --enable=features=%{-E*}}%{-O:%{!?-O*: --ozone-platform-hint=auto}}%{-O:%{-O*: --ozone-platform=%{-O*}}}%{?desktop_file_args: --%{desktop_file_args}}%{-U: %{-U*}}\\" squashfs-root/*.desktop"))
   end}                                                                                                                \
%{-l:%{expand:BUNDLED_LICENSE_DIR="$PWD/bundled_licenses"
%{__mkdir} -p "$BUNDLED_LICENSE_DIR"
find ./*/ -iname "*LICENSE*" -type f ! -name "*.zip" ! -path "./node_modules/*" ! -path "./*/node_modules/*" ! -path "./public/*" ! -name "$BUNDLED_LICENSE_DIR" ! -path "./$BUNDLED_LICENSE_DIR/*" -exec cp -p -t "$BUNDLED_LICENSE_DIR" {} +}}                                                        \
if [[ "$BUILDER" == "electron-builder" ]]; then                                                                        \
%{__install} -Dm644 dist/.icon-set/*16.png %{buildroot}%{_hicolordir}/16x16/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png       \
%{__install} -Dm644 dist/.icon-set/*32.png %{buildroot}%{_hicolordir}/32x32/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png       \
%{__install} -Dm644 dist/.icon-set/*48.png %{buildroot}%{_hicolordir}/48x48/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png       \
%{__install} -Dm644 dist/.icon-set/*64.png %{buildroot}%{_hicolordir}/64x64/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png       \
%{__install} -Dm644 dist/.icon-set/*128.png %{buildroot}%{_hicolordir}/128x128/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png    \
%{__install} -Dm644 dist/.icon-set/*256.png %{buildroot}%{_hicolordir}/256x256/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png    \
%{__install} -Dm644 dist/.icon-set/*512.png %{buildroot}%{_hicolordir}/512x512/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png    \
%{__install} -Dm644 dist/.icon-set/*1024.png %{buildroot}%{_hicolordir}/1024x1024/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png \
elif [[ "$BUILDER" == "electron-forge" ]]; then                                                                        \
%{__install} -Dm644 assets/app-icon.png %{buildroot}%{_hicolordir}/512x512/apps/%{-i:%{-i*}}%{!?-i:%{name}}.png        \
fi
